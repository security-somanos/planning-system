## Event & Trip Planning System - Backend (Go + PostgreSQL)

Production-ready REST backend for the event and trip planning system. Designed to mirror the existing frontend schema and endpoints.

### Tech
- Language: Go 1.22+
- Router: chi
- DB: PostgreSQL (pgx pool)
- Migrations: golang-migrate (embedded iofs)
- Logging: zerolog (structured)
- CORS: Allowed for common local dev origins

### Project Layout
- `cmd/api/` - server entrypoint
- `cmd/migrate/` - CLI to run migrations up/down
- `cmd/seed/` - CLI to run the dev seed
- `internal/config/` - env/config and logger
- `internal/http/` - router and middleware
- `internal/handlers/` - HTTP handlers per resource
- `internal/services/` - service layer
- `internal/repos/` - DB repos and queries
- `internal/models/` - request/response DTOs
- `internal/db/migrations/` - SQL up/down
- `internal/db/seed/` - dev seeder
- `pkg/respond/` - JSON helpers

### Env Vars
- `DATABASE_URL` (required): Postgres URL, e.g. `postgres://user:pass@localhost:5432/planning?sslmode=disable`
- `PORT` (default: `8080`)
- `ENV` (default: `dev`) - `dev|prod`
- `LOG_LEVEL` (default: `info`) - `debug|info|warn|error`
- `AUTO_MIGRATE` (default: `true`)
- `AUTO_SEED` (default: `true` in dev)
- `CORS_ORIGINS` (comma-separated; defaults to localhost:3000/5173)

You may create a `.env` file in project root for local development.

### Running
```
make dev
```
Server runs on `:8080` by default.

### Migrations
Migrations are embedded and run automatically at server startup if `AUTO_MIGRATE=true`.

Manual:
```
make migrate-up
make migrate-down
```

### Seeding (dev)
Seeding will insert a default event, Istanbul locations, demo participants/vehicles, two days, blocks with schedule items, and movements with assignments/passengers.

Automatic in dev if `AUTO_SEED=true`.
Manual:
```
make seed
```

### Endpoints (JSON)
- Locations
  - GET `/locations`
  - POST `/locations`
  - GET `/locations/:id`
  - PUT `/locations/:id`
  - DELETE `/locations/:id`
- Vehicles
  - GET `/vehicles`
  - POST `/vehicles`
  - GET `/vehicles/:id`
  - PUT `/vehicles/:id`
  - DELETE `/vehicles/:id`
- Participants
  - GET `/participants?limit&offset&search&role`
  - POST `/participants`
  - GET `/participants/:id`
  - PUT `/participants/:id`
  - DELETE `/participants/:id`
- Days
  - GET `/days`
  - POST `/days` (body can be `{ "from_date": "YYYY-MM-DD", "to_date": "YYYY-MM-DD" }` or `{ "event_id": "...", "date": "YYYY-MM-DD" }`)
  - GET `/days/:id`
  - DELETE `/days/:id`
- Blocks
  - GET `/days/:dayId/blocks`
  - POST `/days/:dayId/blocks`
  - GET `/days/:dayId/blocks/:blockId`
  - PUT `/days/:dayId/blocks/:blockId`
  - DELETE `/days/:dayId/blocks/:blockId`
- Movements
  - GET `/days/:dayId/movements`
  - POST `/days/:dayId/movements`
  - GET `/days/:dayId/movements/:movementId`
  - PUT `/days/:dayId/movements/:movementId`
  - DELETE `/days/:dayId/movements/:movementId`
- Itinerary and Agenda
  - GET `/itinerary` → returns per-day blocks and movements
  - GET `/agenda/:participantId` → returns participant’s assigned blocks with day/date/time

### Response shapes
- Success list: `{ "items": [...], "total"?: number }`
- Success single: `{ "item": { ... } }`
- Error: `{ "error": "message" }`

### Notes
- IDs are UUID v4 (generated by DB default or Go).
- Dates stored as `DATE`, times as `TIME WITHOUT TIME ZONE`.
- Movements support `to_time_type: "fixed"|"driving"` with either `to_time` (HH:mm) or `driving_minutes` (int).
- Optional capacity validation for vehicle passenger counts can be added in services layer if needed.


